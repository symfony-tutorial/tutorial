    {%- set formType =  form_type_name|lower %}
    
    public function testIndexAction()
    {
        $client = static::createClient();
        $crawler = $client->request('GET', '/{{ route_prefix }}');
        $unexpectedStatus = "Unexpected HTTP status code for GET /{{ route_prefix }}";
        $this->assertEquals(200, $client->getResponse()->getStatusCode(), $unexpectedStatus);
    }
    
    public function testNewAction()
    {
        $client = static::createClient();
        $crawler = $this->createNewEntity($client, '/{{route_prefix}}', '{{formType}}');

        foreach ($this->getNewFormFields() as $value) {
            $missingElementError = sprintf('Missing element td:contains("%s")', $value);
            $valueCount = $crawler->filter(sprintf('td:contains("%s")', $value))->count();
            $this->assertGreaterThan(0, $valueCount, $missingElementError);
        }
    }
    
    public function testUpdateAction()
    {
        $client = static::createClient();
        $crawler = $this->createNewEntity($client, '/{{route_prefix}}', '{{formType}}');
        
        $crawler = $client->click($crawler->selectLink('Edit')->link());
        
        $formFields = $this->getUpdateFormFields();

        $form = $crawler->selectButton('Update')->form(
            $this->constructFormValues($formFields, '{{formType}}')
        );

        $client->submit($form);
        $crawler = $client->followRedirect();

        foreach ($this->getUpdateFormFields() as $value) {
            $missingElementError = sprintf('Missing element td:contains("%s")', $value);
            $valueCount = $crawler->filter(sprintf('[value="%s"]', $value))->count();
            $this->assertGreaterThan(0, $valueCount, $missingElementError);
        }
    }
    
    /**
     * 
     * @return array 'field_name'=>'value' to be used for testNewAction
     */
    protected function getNewFormFields()
    {
        return array(
            'field_name' => 'value',
            //other fields
        );
    }
    /**
     * 
     * @return array 'field_name'=>'value' to be used for testUpdateAction
     */
    protected function getUpdateFormFields()
    {
        return $this->getNewFormFields();
    }
    
    protected function constructFormValues($fields, $formTypeName)
    {
        $values = array();
        foreach ($fields as $fieldName => $value) {
            $values[sprintf('%s[%s]', $formTypeName, $fieldName)] = $value;
        }
        return $values;
    }
    
    protected function createNewEntity(Client $client, $routePrefix, $formTypeName)
    {
        $crawler = $client->request('GET', $routePrefix);
        $crawler = $client->click($crawler->selectLink('Create a new entry')->link());

        $form = $crawler->selectButton('Create')->form(
                $this->constructFormValues($this->getNewFormFields(), $formTypeName)
        );

        $client->submit($form);
        return $client->followRedirect();
    }
    